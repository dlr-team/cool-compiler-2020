%===================================================================================
% JORNADA CIENTÍFICA ESTUDIANTIL - MATCOM, UH
%===================================================================================
% Esta plantilla ha sido diseñada para ser usada en los artículos de la
% Jornada Científica Estudiantil, MatCom.
%
% Por favor, siga las instrucciones de esta plantilla y rellene en las secciones
% correspondientes.
%
% NOTA: Necesitará el archivo 'jcematcom.sty' en la misma carpeta donde esté este
%       archivo para poder utilizar esta plantila.
%===================================================================================



%===================================================================================
% PREÁMBULO
%-----------------------------------------------------------------------------------
\documentclass[a4paper,10pt,twocolumn]{article}

%===================================================================================
% Paquetes
%-----------------------------------------------------------------------------------
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{informe}
\usepackage[utf8]{inputenc}
\usepackage{listings}
\usepackage[pdftex]{hyperref}
%-----------------------------------------------------------------------------------
% Configuración
%-----------------------------------------------------------------------------------
\hypersetup{colorlinks,%
	    citecolor=black,%
	    filecolor=black,%
	    linkcolor=black,%
	    urlcolor=blue}

%===================================================================================



%===================================================================================
% Presentacion
%-----------------------------------------------------------------------------------
% Título
%-----------------------------------------------------------------------------------
\title{Informe de Entrega CoolCompiler 2020}

%-----------------------------------------------------------------------------------
% Autores
%-----------------------------------------------------------------------------------
\author{\\
	\name  Jorge Daniel Valle Díaz \email \href{mailto:jorge.valle@estudiantes.matcom.uh.cu}{jorge.valle@estudiantes.matcom.uh.cu}
	\\ \addr Grupo C412 \AND
	\name Leonel Alejandro Garc\'ia L\'opez \email \href{mailto:l.garcia3@estudiantes.matcom.uh.cu}{l.garcia3@estudiantes.matcom.uh.cu}
	\\ \addr Grupo C412 \AND
	\name Roberto Marti Cede\~no \email \href{mailto:r.marti@estudiantes.matcom.uh.cu}{r.marti@estudiantes.matcom.uh.cu}
	\\ \addr Grupo C412
} 

%-----------------------------------------------------------------------------------
% Tutores
%-----------------------------------------------------------------------------------
\tutors{\\
Msc. Alejandro Piad Morffis, \emph{Facultad de Matemática y Computación, Universidad de La Habana}}

%-----------------------------------------------------------------------------------
% Headings
%-----------------------------------------------------------------------------------
\jcematcomheading{\the\year}{1-\pageref{end}}{Jorge Daniel Valle Díaz, Leonel Alejandro Garc\'ia L\'opez, Roberto Marti Cede\~no}

%-----------------------------------------------------------------------------------
\ShortHeadings{Ejemplo JCE}{Autores}
%===================================================================================



%===================================================================================
% DOCUMENTO
%-----------------------------------------------------------------------------------
\begin{document}

%-----------------------------------------------------------------------------------
% NO BORRAR ESTA LINEA!
%-----------------------------------------------------------------------------------
\twocolumn[
%-----------------------------------------------------------------------------------

\maketitle

%===================================================================================
% Resumen y Abstract
%-----------------------------------------------------------------------------------
\selectlanguage{spanish} % Para producir el documento en Español

%-----------------------------------------------------------------------------------
% Resumen en Español
%-----------------------------------------------------------------------------------


\vspace{0.5cm}

%-----------------------------------------------------------------------------------
% Palabras clave
%-----------------------------------------------------------------------------------

%-----------------------------------------------------------------------------------
% Temas
%-----------------------------------------------------------------------------------
\begin{topics}
	Compilación, Cool Language.
\end{topics}


%-----------------------------------------------------------------------------------
% NO BORRAR ESTAS LINEAS!
%-----------------------------------------------------------------------------------
\vspace{0.8cm}
]
%-----------------------------------------------------------------------------------


%===================================================================================

%===================================================================================
% Introducción
%-----------------------------------------------------------------------------------
\section{Introducción}\label{sec:intro}
%-----------------------------------------------------------------------------------
	El siguiente trabajo representa el informe sobre la confección del compilador. Para la confección del mismo se empleó el lenguaje python de programación. El proyecto se dividió en varias etapas: Análisis lexicográfico, sintáctico, semántico, código intermedio y generación de código de máquina. Es importante destacar que se reutilizaron en la medida de lo posible los archivos de clase práctica y los proyectos realizados en el curso previo de la asignatura.

%===================================================================================



%===================================================================================
% Desarrollo
%-----------------------------------------------------------------------------------
\section{Lexer}\label{sec:dev}
%-----------------------------------------------------------------------------------
	En la fase de análisis lexicográfico se empleó la biblioteca ply, en especial su módulo lex. 
	Salvo en el caso de las cadenas de caracteres y los comentarios multi-línea, el resto de los tokens fueron procesados mediante expresiones regulares. Para el caso de las cadenas de caracteres y los comentarios multi-líneas se emplearon estados especiales exclusivos. 
	
\section{Parser}
	La fase de análisis sintáctico ha sido una de las fases mas controversiales a la hora de la realización del proyecto. Se empleó en una primera fase el parser LR1 tomado de clase práctica y los proyectos previos de la asignatura. La gramática que se definió durante la primera entrega del proyecto contenía ambigüedades, las cuales fueron detectada comprobando las pruebas correspondientes a la parte de semántica. 
	
	Dado el tiempo restante que se disponía para la entrega, el equipo decidió tratar de adelantar todas las funcionalidades posibles para minimizar los cambios después de la fecha de entrega. 
	
	Actualmente se esta valorando la posibilidad de emplear el módulo yacc de ply para definir la gramática y evitar las ambigüedades que se desprenden de nuestra implementación inicial.
	
\section{Análisis Semántico}

	La fase de análisis semántico se compuso por 3 recorridos del árbol de sintaxis abstracta derivado de la fase de análisis sintáctico que siguen el patrón visitor.
	
	\begin{description}
		\item [Recolector de tipos:] Primer recorrido del ast, en el cual se conforman los tipos nativos y los definidos en el archivo de código a procesar. En este mismo recorrido también se detectan los problemas relacionados con la herencia cíclica.
		\item [Constructor de tipos:] Segundo recorrido del ast, en el cual se construyen los tipos, se definen sus métodos y atributos. 
		\item [Verificador de tipos:] Tercer y ultimo recorrido del ast, en el cual se verifica la estructura de cada uno de los nodos del ast, este recorrido es el que mas abarca las reglas semánticas del lenguaje cool.
	\end{description}

\section{Código intermedio y código de máquina}

El equipo decidió realizar una representación intermedia del lenguaje cool antes de pasar a la generación de código de máquina. Para ello se definieron 2 nuevos recorridos a árboles de sintaxis.

\subsection{Código intermedio}
	
 Del AST obtenido en las fases anteriores, en un cuarto recorrido se realizó una transformación hacia un AST de  CIL  que facilitara que el comportamiento obtenido en  COOL  sea mas factible a un representacion en MIPS.
 Aqui existio una vez mas apoyo en los elementos de clase practica, al contar con un transpliador base para definir todas la convenciones tomadas, asi como contener los metodos necesarios para dicha conversion.
 En esta fase surgió la necesidad de resolver  un conjunto de escpecificaciones como son: 

 Es también en esta fase donde se da por fin una implementación real a los tipos y
 funciones básicas definidas por el lenguaje. Estas hacen uso de nodos especiales
 del AST que solo son instanciadas para su uso desde  COOL a través de las funciones
 básicas. Ejemplo son los métodos para la entrada y salida de datos brindada por la
 clase  IO . Con estas estructuras definidas en el AST de  CIL , durante la traducción a
 MIPS , ellas serán generadas automáticamente.
	\begin{itemize}
		\item \textbf{Relacionado a la herencia} mantenemos como tipos de cil como el conjunto de atributos de los respectivos en cool pero con los de sus antecesores en la jerarqu\'ia de tipos(los m\'etodos y la tabla virtual queda para resolverse en mips)
		\item \textbf{De los tipos por valor} El problema de los tipos por valor  Int y	Bool, y de los  Strings como casos especiales, al ser usados como un objeto por referencia. Para esto se definió una representación en memorias para los casos en
		que esto ocurriera. Todos estos tipos cuando fuera necesario tratarlos como objetos
		por referencias, para por ejemplo acceder a las funciones heredadas de la clase
		Object o las propiamente definidas por el tipo String , serían encapsulados en
		instancias similares a los otros tipos, la cual contaría con un atributo value en el cual
		se almacenaría el valor real de los mismos.
		\item \textbf{Inicializaci\'on de atributos} Una de las especificaciones que se tuvo en cuenta para la generación de CIL fue la inicialización
		de los atributos, tanto los heredados como los propios de la clase. Cuando se crea una instancia
		de una clase se deben inicializar todos sus atributos con su expresión inicial, si tienen alguna;
		en otro caso se usa su expresión por defecto. Con el objetivo de lograr esto se creó para cada
		tipo un constructor, cuyo cuerpo consiste en un bloque, dándole un valor a cada uno de sus
		atributos. Este es llamado cada vez que se instancia un tipo.
		\item \textbf{Para las estructuras \textit{CaseOf}} de cool realizamos un ordenamiento (dicho ordenamiento fue realizado de acuerdo a la profundidad de los tipos en la jerarqu\'ias, desde el m\'as espec\'ifico, hasta el mas cercano a \textit{Object}) de los \textit{case actions} para realizar un \textit{matching} no iterativo y a partir del primer tipo presente en la jerarqu\'ia del objeto resultante de la expresi\'on del case.
		Luego esta lista que llamamos \textbf{CaseActionExpressions} se extende de manera ordenada para a\~nadir los tipos mas espec\'ificos de los que se encontraban originalmente que a su vez como expresi\'on a realizar ser\'ia la mismo que el ancestro del que extendio, quedando una lista con bloques de case donde antes solo una opci\'on (conservando el orden anterior pero solo por bloques), de forma tal que en tiempo de ejecuci\'on el primer \textit{matching} fuese el correcto a realizar.
	\end{itemize}
	


\subsection{Código de máquina}
 \'Ultimo recorrido, en este caso del árbol de sintaxis de representación intermedia. Mediante el cual se genera el código a ejecutar en el microprocesador con arquitectura MIPS.


\label{end}

\end{document}

%===================================================================================
